--Cumulative revenue generated over time
WITH revenue AS 
(SELECT date,ROUND(SUM ( price*quantity)::NUMERIC,2) total_revenue
FROM pizzas P 
JOIN ORDER_DETAILS od
ON P.PIZZA_ID=od.PIZZA_ID
JOIN orders o 
ON o.order_id = od.order_id
GROUP BY O.date)

SELECT date,revenue.total_revenue,
SUM(total_revenue) OVER (ORDER BY date) cumulative_reveneu
FROM revenue
ORDER BY date;

/*
ANS
    Date        Revenue    Cumulative_reveneu
"2015-01-01"	2713.85     2713.85
"2015-01-02"	2731.90	    5445.75
"2015-01-03"	2662.40	 	8108.15
"2015-01-04"	1755.45	 	9863.60
"2015-01-05"	2065.95	 	11929.55
"2015-01-06"	2428.95	 	14358.50
"2015-01-07"	2202.20	 	16560.70
"2015-01-08"	2838.35	 	19399.05
"2015-01-09"	2127.35	 	21526.40
"2015-01-10"	2463.95	 	23990.35
"2015-01-11"	1872.30	 	25862.65
"2015-01-12"	1919.05	 	27781.70
"2015-01-13"	2049.60	 	29831.30
"2015-01-14"	2527.40	 	32358.70
"2015-01-15"	1984.80		34343.50
"2015-01-16"	2594.15		36937.65
"2015-01-17"	2064.10		39001.75
"2015-01-18"	1976.85		40978.60
"2015-01-19"	2387.15		43365.75
"2015-01-20"	2397.90		45763.65
"2015-01-21"	2040.55		47804.20
"2015-01-22"	2496.70		50300.90
"2015-01-23"	2423.70		52724.60
"2015-01-24"	2289.25		55013.85
"2015-01-25"	1617.55		56631.40
"2015-01-26"	1884.40		58515.80
"2015-01-27"	2528.05		61043.85
"2015-01-28"	2016.00		63059.85
"2015-01-29"	2045.30		65105.15
"2015-01-30"	2270.30		67375.45
"2015-01-31"	2417.85		69793.30
"2015-02-01"	3189.20		72982.50
"2015-02-02"	2328.60		75311.10
"2015-02-03"	2614.80		77925.90
"2015-02-04"	2233.90		80159.80
"2015-02-05"	2215.80		82375.60
"2015-02-06"	2509.95		84885.55
"2015-02-07"	2237.65		87123.20
"2015-02-08"	2035.00		89158.20
"2015-02-09"	2195.35	    91353.55
"2015-02-10"	2056.50		93410.05
"2015-02-11"	2460.00		95870.05
"2015-02-12"	2158.80		98028.85
"2015-02-13"	2754.50		100783.35
"2015-02-14"	2319.15		103102.50
"2015-02-15"	2141.25		105243.75
"2015-02-16"	1968.80		107212.55
"2015-02-17"	2121.90		109334.45
"2015-02-18"	2642.85		111977.30
"2015-02-19"	2030.25		114007.55
"2015-02-20"	2891.15		116898.70
"2015-02-21"	2111.00		119009.70
"2015-02-22"	1579.95		120589.65
"2015-02-23"	2168.55		122758.20
"2015-02-24"	2194.55		124952.75
"2015-02-25"	2341.30		127294.05
"2015-02-26"	2261.30		129555.35
"2015-02-27"	2857.95		132413.30
"2015-02-28"	2539.60		134952.90
"2015-03-01"	1598.55		136551.45
"2015-03-02"	2379.05		138930.50
"2015-03-03"	2287.90		141218.40
"2015-03-04"	2444.30		143662.70
"2015-03-05"	2350.65		146013.35
"2015-03-06"	2513.95		148527.30
"2015-03-07"	2400.45		150927.75
"2015-03-08"	2188.15		153115.90
"2015-03-09"	2334.55		155450.45
"2015-03-10"	2388.70		157839.15
"2015-03-11"	2207.70		160046.85
"2015-03-12"	1994.90		162041.75
"2015-03-13"	2786.65		164828.40
"2015-03-14"	2039.45		166867.85
"2015-03-15"	2068.60		168936.45
"2015-03-16"	2295.05		171231.50
"2015-03-17"	2965.30		174196.80
"2015-03-18"	2075.40		176272.20
"2015-03-19"	2388.60		178660.80
"2015-03-20"	2461.25		181122.05
"2015-03-21"	2267.40		183389.45
"2015-03-22"	1259.25		184648.70
"2015-03-23"	2232.55		186881.25
"2015-03-24"	2162.30		189043.55
"2015-03-25"	1927.75		190971.30
"2015-03-26"	2215.50		193186.80
"2015-03-27"	2744.80		195931.60
"2015-03-28"	2252.10		198183.70
"2015-03-29"	2154.25		200337.95
"2015-03-30"	2255.45		202593.40
"2015-03-31"	2756.60		205350.00
"2015-04-01"	2176.85		207526.85
"2015-04-02"	2547.15		210074.00
"2015-04-03"	2538.20		212612.20
"2015-04-04"	2767.55		215379.75
"2015-04-05"	1909.85		217289.60
"2015-04-06"	2622.35		219911.95
"2015-04-07"	2234.25		222146.20
"2015-04-08"	2293.95		224440.15
"2015-04-09"	2047.30		226487.45
"2015-04-10"	2424.95		228912.40
"2015-04-11"	2543.75		231456.15
"2015-04-12"	1994.30		233450.45
"2015-04-13"	2496.20		235946.65
"2015-04-14"	2505.70		238452.35
"2015-04-15"	2578.85		241031.20
"2015-04-16"	2017.95		243049.15
"2015-04-17"	2675.65		245724.80
"2015-04-18"	2286.20		248011.00
"2015-04-19"	1527.95		249538.95
"2015-04-20"	2459.45		251998.40
"2015-04-21"	2213.15		254211.55
"2015-04-22"	2193.45		256405.00
"2015-04-23"	2426.15		258831.15
"2015-04-24"	2979.20		261810.35
"2015-04-25"	2089.20		263899.55
"2015-04-26"	1767.40		265666.95
"2015-04-27"	2180.80		267847.75
"2015-04-28"	1742.80		269590.55
"2015-04-29"	1828.75		271419.30
"2015-04-30"	2667.50		274086.80
"2015-05-01"	2571.95		276658.75
"2015-05-02"	2400.20		279058.95
"2015-05-03"	1832.25		280891.20
"2015-05-04"	2288.90		283180.10
"2015-05-05"	1713.60		284893.70
"2015-05-06"	2309.80		287203.50
"2015-05-07"	2228.85		289432.35
"2015-05-08"	3052.30		292484.65
"2015-05-09"	2368.40		294853.05
"2015-05-10"	2288.35		297141.40
"2015-05-11"	2388.05		299529.45
"2015-05-12"	2299.70		301829.15
"2015-05-13"	2261.80		304090.95
"2015-05-14"	2694.50		306785.45
"2015-05-15"	3386.15		310171.60
"2015-05-16"	2281.10		312452.70
"2015-05-17"	1828.40		314281.10
"2015-05-18"	2209.65		316490.75
"2015-05-19"	1987.00		318477.75
"2015-05-20"	2373.00		320850.75
"2015-05-21"	2062.55		322913.30
"2015-05-22"	2635.10		325548.40
"2015-05-23"	2444.15		327992.55
"2015-05-24"	2196.95		330189.50
"2015-05-25"	2104.40		332293.90
"2015-05-26"	1876.45		334170.35
"2015-05-27"	2097.00		336267.35
"2015-05-28"	2016.40		338283.75
"2015-05-29"	3001.20		341284.95
"2015-05-30"	2486.95		343771.90
"2015-05-31"	1717.65		345489.55
"2015-06-01"	3067.75		348557.30
"2015-06-02"	2449.95		351007.25
"2015-06-03"	1907.05		352914.30
"2015-06-04"	2283.60		355197.90
"2015-06-05"	2700.15		357898.05
"2015-06-06"	2280.95		360179.00
"2015-06-07"	1960.75		362139.75
"2015-06-08"	2264.95		364404.70
"2015-06-09"	2442.55		366847.25
"2015-06-10"	2019.40		368866.65
"2015-06-11"	2650.50		371517.15
"2015-06-12"	2138.60		373655.75
"2015-06-13"	2508.90		376164.65
"2015-06-14"	1859.00		378023.65
"2015-06-15"	2595.60		380619.25
"2015-06-16"	1898.30		38217.55
"2015-06-17"	2137.10		384654.65
"2015-06-18"	1984.50		386639.15
"2015-06-19"	2793.45		389432.60
"2015-06-20"	2060.60		391493.20
"2015-06-21"	1925.20		393418.40
"2015-06-22"	2319.30		395737.70
"2015-06-23"	2042.75		397780.45
"2015-06-24"	2327.50		400107.95
"2015-06-25"	2399.15		402507.10
"2015-06-26"	2745.50		405252.60
"2015-06-27"	2812.90		408065.50
"2015-06-28"	1569.70		409635.20
"2015-06-29"	1873.60		411508.80
"2015-06-30"	2210.95		413719.75
"2015-07-01"	2231.50		415951.25
"2015-07-02"	2294.80		418246.05
"2015-07-03"	3443.00		421689.05
"2015-07-04"	3864.20		425553.25
"2015-07-05"	1591.45		427144.70
"2015-07-06"	2116.90		429261.60
"2015-07-07"	2374.40		431636.00
"2015-07-08"	2396.05		434032.05
"2015-07-09"	2297.75		436329.80
"2015-07-10"	2432.40		438762.20
"2015-07-11"	2085.55		440847.75
"2015-07-12"	2185.65		443033.40
"2015-07-13"	2059.50		445092.90
"2015-07-14"	1956.50		447049.40
"2015-07-15"	2501.80		449551.20
"2015-07-16"	2463.90		452015.10
"2015-07-17"	3131.65		455146.75
"2015-07-18"	2122.20		457268.95
"2015-07-19"	2022.70		459291.65
"2015-07-20"	2501.00		461792.65
"2015-07-21"	2030.85		463823.50
"2015-07-22"	2292.10		466115.60
"2015-07-23"	2214.50		468330.10
"2015-07-24"	3204.40		471534.50
"2015-07-25"	2237.25		473771.75
"2015-07-26"	1871.55		475643.30
"2015-07-27"	2172.00		477815.30
"2015-07-28"	2094.55		479909.85
"2015-07-29"	1923.25		481833.10
"2015-07-30"	2349.15		484182.25
"2015-07-31"	2095.40		486277.65
"2015-08-01"	2440.55		488718.20
"2015-08-02"	1910.15		490628.35
"2015-08-03"	1982.25		492610.60
"2015-08-04"	2090.15		494700.75
"2015-08-05"	2094.85		496795.60
"2015-08-06"	2099.25		498894.85
"2015-08-07"	2626.40		501521.25
"2015-08-08"	2716.40		504237.65
"2015-08-09"	2002.65		506240.30
"2015-08-10"	2139.45		508379.75
"2015-08-11"	2290.00		510669.75
"2015-08-12"	2365.75		513035.50
"2015-08-13"	2074.15		515109.65
"2015-08-14"	3016.60		518126.25
"2015-08-15"	2252.35		520378.60
"2015-08-16"	2139.30		522517.90
"2015-08-17"	2626.00		525143.90
"2015-08-18"	2101.20		527245.10
"2015-08-19"	2332.95		529578.05
"2015-08-20"	1907.70		531485.75
"2015-08-21"	2601.40		534087.15
"2015-08-22"	2406.00		536493.15
"2015-08-23"	1701.60		538194.75
"2015-08-24"	1697.05		539891.80
"2015-08-25"	1958.90		541850.70
"2015-08-26"	2329.40		544180.10
"2015-08-27"	2117.65		546297.75
"2015-08-28"	2647.20		548944.95
"2015-08-29"	2035.00		550979.95
"2015-08-30"	1494.60		552474.55
"2015-08-31"	2081.35		554555.90
"2015-09-01"	2352.85		556908.75
"2015-09-02"	1865.55		558774.30
"2015-09-03"	2252.60		561026.90
"2015-09-04"	2960.95		563987.85
"2015-09-05"	2537.80		566525.65
"2015-09-06"	1491.65		568017.30
"2015-09-07"	2283.35		570300.65
"2015-09-08"	2249.50		572550.15
"2015-09-09"	2580.10		575130.25
"2015-09-10"	2415.85		577546.10
"2015-09-11"	2761.90		580308.00
"2015-09-12"	2588.15		582896.15
"2015-09-13"	1838.15		584734.30
"2015-09-14"	2165.25		586899.55
"2015-09-15"	2550.20		589449.75
"2015-09-16"	2185.25		591635.00
"2015-09-17"	2242.05		593877.05
"2015-09-18"	2721.55		596598.60
"2015-09-19"	2286.55		598885.15
"2015-09-20"	1829.00		600714.15
"2015-09-21"	2131.45		602845.60
"2015-09-22"	2170.40		605016.00
"2015-09-23"	2163.00		607179.00
"2015-09-26"	2246.85		609425.85
"2015-09-27"	2314.70		611740.55
"2015-09-28"	2035.30		613775.85
"2015-09-29"	2762.05		616537.90
"2015-09-30"	2198.05		618735.95
"2015-10-01"	3202.15		621938.10
"2015-10-02"	2074.85		624012.95
"2015-10-03"	2400.95		626413.90
"2015-10-04"	2142.20		628556.10
"2015-10-06"	2215.95		630772.05
"2015-10-07"	2092.35		632864.40
"2015-10-08"	1975.85		634840.25
"2015-10-09"	2512.60		637352.85
"2015-10-10"	2310.20		639663.05
"2015-10-11"	1916.25		641579.30
"2015-10-13"	2325.95		643905.25
"2015-10-14"	2146.35		646051.60
"2015-10-15"	4320.20		650371.80
"2015-10-16"	2555.10		652926.90
"2015-10-17"	2339.80		655266.70
"2015-10-18"	1795.30		657062.00
"2015-10-20"	2437.15		659499.15
"2015-10-21"	2460.50		661959.65
"2015-10-22"	2400.90		664360.55
"2015-10-23"	2610.65		666971.20
"2015-10-24"	2679.50		669650.70
"2015-10-25"	1837.05		671487.75
"2015-10-27"	1988.65		673476.40
"2015-10-28"	1635.95		675112.35
"2015-10-29"	2169.75		677282.10
"2015-10-30"	2736.60		680018.70
"2015-10-31"	2744.85		682763.55
"2015-11-01"	1986.65		684750.20
"2015-11-02"	2299.10		687049.30
"2015-11-03"	1828.55		688877.85
"2015-11-04"	1966.10		690843.95
"2015-11-05"	2180.35		693024.30
"2015-11-06"	3157.50		696181.80
"2015-11-07"	2580.95		698762.75
"2015-11-08"	2110.15		700872.90
"2015-11-09"	2483.75		703356.65
"2015-11-10"	2042.60		705399.25
"2015-11-11"	1946.20		707345.45
"2015-11-12"	2564.80		709910.25
"2015-11-13"	2264.55		712174.80
"2015-11-14"	2324.75		714499.55
"2015-11-15"	1821.65		716321.20
"2015-11-16"	2256.65		718577.85
"2015-11-17"	1956.55		720534.40
"2015-11-18"	2111.70		722646.10
"2015-11-19"	2694.90		725341.00
"2015-11-20"	2388.10		727729.10
"2015-11-21"	2083.95		729813.05
"2015-11-22"	1368.70		731181.75
"2015-11-23"	2465.15		733646.90
"2015-11-24"	2230.05		735876.95
"2015-11-25"	2363.25		738240.20
"2015-11-26"	4405.95		742646.15
"2015-11-27"	4422.45		747068.60
"2015-11-28"	1968.05		749036.65
"2015-11-29"	1899.00		750935.65
"2015-11-30"	2223.25		753158.90
"2015-12-01"	2076.70		755235.60
"2015-12-02"	2214.10		757449.70
"2015-12-03"	2243.20		759692.90
"2015-12-04"	2878.35		762571.25
"2015-12-05"	2627.95		765199.20
"2015-12-06"	2350.25		767549.45
"2015-12-07"	2414.80		769964.25
"2015-12-08"	1856.25		771820.50
"2015-12-09"	2571.55		774392.05
"2015-12-10"	1985.60		776377.65
"2015-12-11"	2634.00		779011.65
"2015-12-12"	1960.15		780971.80
"2015-12-13"	2245.15		783216.95
"2015-12-14"	2172.60		785389.55
"2015-12-15"	2387.45		787777.00
"2015-12-16"	2234.80		790011.80
"2015-12-17"	1880.75		791892.55
"2015-12-18"	2886.30		794778.85
"2015-12-19"	2304.20		797083.05
"2015-12-20"	2104.90		799187.95
"2015-12-21"	2100.70		801288.65
"2015-12-22"	1882.95		803171.60
"2015-12-23"	2244.30		805415.90
"2015-12-24"	2137.85		807553.75
"2015-12-26"	1643.05		809196.80
"2015-12-27"	1419.00		810615.80
"2015-12-28"	1637.20		812253.00
"2015-12-29"	1353.25		813606.25
"2015-12-30"	1337.80		814944.05
"2015-12-31"	2916.00 	817860.05  
*/